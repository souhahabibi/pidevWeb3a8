{% extends 'client_base.html.twig' %}

{% block breadcrumb %}
<section class="breadcrumb-section set-bg mb-4" data-setbg="{{asset('clientSalle/img/about-breadcrumb-bg.jpg')}}">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="site-text">
                    <h2>{% block title %}OUR PRODUCTS{% endblock %}</h2>
                    <div class="site-breadcrumb">
                        <a href="./home.html" class="sb-item">Home</a>
                        <span class="sb-item">{% block page %}products{% endblock %}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}

{% block body %}

<div class="row">
    <div class="col-lg-12">
        <div class="col-lg-12">
            <div class="section-title">
                <h2>Search Bar</h2>
                <input type="text" id="searchInput" placeholder="Search by name..." oninput="search()">
            </div>  
        </div>
    </div>
</div>

{% if produits is empty %}
    <p>Aucun produit trouvé.</p>
{% else %}
    <div class="row">
        {% for produit in produits %}
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="card">
                    {% if produit.image %}
                        <img src="{{ asset('adminSalle/img/' ~ produit.image) }}" class="card-img-top" alt="Image du produit">
                    {% else %}
                        <div class="text-center">Pas d'image</div>
                    {% endif %}
                    <div class="card-body">
                        <h5 class="card-title text-center">{{ produit.nom }}</h5>
    
                        <p class="card-text"><small class="text-muted">Description: {{ produit.description }}</small></p>
                        <p class="card-text"><small class="text-muted">Prix: {{ produit.cout }}</small></p>
                        <p class="card-text"><small class="text-muted">Date d'expiration: {{ produit.dateExpiration ? produit.dateExpiration|date('Y-m-d') : 'N/A' }}</small></p>
                        <div class="text-right">
                            <a href="#" class="btn btn-danger">QR Code</a>
                        </div>
                    </div>
                </div>
            </div>
            {% if loop.index % 3 == 0 %}</div><div class="row">{% endif %}
        {% endfor %}
    </div>
{% endif %}

<script>
    function search() {
        // Récupère la valeur de la recherche
        let input = document.getElementById("searchInput");
        let filter = input.value.toUpperCase();

        // Récupère tous les noms de produits à filtrer
        let names = document.querySelectorAll(".card-title");

        // Parcours tous les noms et masque les éléments dont le nom ne correspond pas à la recherche
        names.forEach(name => {
            let text = name.textContent || name.innerText;
            let item = name.closest(".col-lg-4");
            if (text.toUpperCase().indexOf(filter) > -1) {
                item.style.display = "";
            } else {
                item.style.display = "none";
            }
        });
    }
</script>

{% endblock %}
